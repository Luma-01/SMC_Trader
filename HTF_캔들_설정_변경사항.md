# HTF ìº”ë“¤ ì„¤ì • ë³€ê²½ì‚¬í•­ (ìµœê·¼ 50ê°œ ìº”ë“¤ ê¸°ì¤€)

## ğŸ“‹ ë³€ê²½ ìš”ì•½

ì´ ë¬¸ì„œëŠ” OTE í™œìš©ì„ ì œì™¸í•˜ê³  ìµœê·¼ 50ê°œ HTF ìº”ë“¤ì„ ê¸°ì¤€ìœ¼ë¡œ ë¶„ì„í•˜ë„ë¡ ì‹œìŠ¤í…œì„ ìˆ˜ì •í•œ ë‚´ìš©ì„ ì •ë¦¬í•©ë‹ˆë‹¤.

## ğŸ”§ ì£¼ìš” ë³€ê²½ì‚¬í•­

### 1. ì„¤ì • íŒŒì¼ ìˆ˜ì • (`config/settings.py`)

```python
# HTF ìº”ë“¤ ì œí•œ ì„¤ì • ì¶”ê°€
HTF_CANDLE_LIMIT = int(os.getenv("HTF_CANDLE_LIMIT", "50"))
USE_OTE_VALIDATION = os.getenv("USE_OTE_VALIDATION", "false").lower() == "true"
```

- **HTF_CANDLE_LIMIT**: HTF íƒ€ì„í”„ë ˆì„ ìº”ë“¤ì„ 50ê°œë¡œ ì œí•œ
- **USE_OTE_VALIDATION**: OTE ê²€ì¦ ë¹„í™œì„±í™” (ê¸°ë³¸ê°’: false)
- ì„¤ì • ìƒíƒœë¥¼ Discord ë©”ì‹œì§€ë¡œ ì¶œë ¥í•˜ë„ë¡ ê°œì„ 

### 2. ë°ì´í„° í”¼ë“œ ìˆ˜ì • (`core/data_feed.py`)

#### ìº”ë“¤ ì €ì¥ì†Œ ê°œì„ 
```python
def _get_candle_limit(timeframe: str) -> int:
    """íƒ€ì„í”„ë ˆì„ë³„ ìº”ë“¤ ì œí•œ ë°˜í™˜ (HTFëŠ” 50ê°œë¡œ ì œí•œ)"""
    return HTF_CANDLE_LIMIT if timeframe == HTF_TF else CANDLE_LIMIT

def _create_candle_deque(tf: str):
    """íƒ€ì„í”„ë ˆì„ë³„ ìº”ë“¤ deque ìƒì„±"""
    limit = _get_candle_limit(tf)
    return deque(maxlen=limit)
```

#### ìº”ë“¤ ì €ì¥ì†Œ ì´ˆê¸°í™”
```python
def initialize_candle_storage(symbol: str):
    """ì‹¬ë³¼ë³„ íƒ€ì„í”„ë ˆì„ ìº”ë“¤ ì €ì¥ì†Œ ì´ˆê¸°í™”"""
    if symbol not in candles:
        candles[symbol] = {}
    
    for tf in TIMEFRAMES:
        if tf not in candles[symbol]:
            candles[symbol][tf] = _create_candle_deque(tf)
```

#### ê³¼ê±° ìº”ë“¤ ë¡œë”© ê°œì„ 
- `initialize_historical()` í•¨ìˆ˜ì—ì„œ HTF ìº”ë“¤ ì œí•œ ì ìš©
- ê° íƒ€ì„í”„ë ˆì„ë³„ë¡œ ì ì ˆí•œ ìº”ë“¤ ìˆ˜ë§Œ ë¡œë”©

### 3. ë©”ì¸ ë¶„ì„ ë¡œì§ ìˆ˜ì • (`main.py`)

```python
# HTF ìº”ë“¤ ìˆ˜ ê²€ì¦ ë¡œì§ ê°œì„ 
min_htf_candles = min(30, HTF_CANDLE_LIMIT)  # ìµœëŒ€ 50ê°œ ì¤‘ ìµœì†Œ 30ê°œ í™•ë³´
if df_htf is None or df_ltf is None or len(df_htf) < min_htf_candles or len(df_ltf) < 30:
    return
```

- HTF ìº”ë“¤ ìˆ˜ ê²€ì¦ì„ 50ê°œ ì œí•œì— ë§ê²Œ ì¡°ì •
- ìµœì†Œ 30ê°œ ìº”ë“¤ í™•ë³´ ì‹œ ë¶„ì„ ì§„í–‰

## ğŸš« OTE í™œìš© ì œì™¸

### í˜„ì¬ ìƒíƒœ
- `core/utils.py`ì— OTE ê²€ì¦ ë¡œì§ì´ ì¡´ì¬í•˜ì§€ë§Œ ì‹¤ì œë¡œ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
- ë©”ì¸ ë¶„ì„ ë¡œì§ì€ IOF (Inefficiency of Fair Value) ê¸°ë°˜ìœ¼ë¡œ ë™ì‘
- `USE_OTE_VALIDATION` ì„¤ì •ì„ í†µí•´ í–¥í›„ OTE í™œìš© ì—¬ë¶€ ì œì–´ ê°€ëŠ¥

### OTE ë¡œì§ (ì°¸ê³ ìš©)
```python
def is_ote_valid(htf_df, ltf_df, direction, window=20):
    # 61.8% - 79% ë¦¬íŠ¸ë ˆì´ìŠ¤ë¨¼íŠ¸ ì˜ì—­ ê³„ì‚°
    ote_high = htf_low + 0.79 * (htf_high - htf_low)
    ote_low = htf_low + 0.618 * (htf_high - htf_low)
    # í˜„ì¬ ê°€ê²©ì´ OTE ì˜ì—­ ë‚´ì— ìˆëŠ”ì§€ ê²€ì¦
```

## ğŸ“Š ë™ì‘ ë°©ì‹

### 1. ìº”ë“¤ ë°ì´í„° ê´€ë¦¬
- **HTF ìº”ë“¤**: ìµœê·¼ 50ê°œë¡œ ì œí•œ (`deque(maxlen=50)`)
- **LTF ìº”ë“¤**: ê¸°ì¡´ 1500ê°œ ìœ ì§€ (`deque(maxlen=1500)`)

### 2. ë¶„ì„ ë¡œì§
- HTF êµ¬ì¡° ë¶„ì„ì€ ìµœê·¼ 50ê°œ ìº”ë“¤ ê¸°ì¤€
- LTF ë°˜ì „ í™•ì¸ì€ ê¸°ì¡´ ë¡œì§ ìœ ì§€
- OTE ê²€ì¦ ë‹¨ê³„ ì™„ì „ ì œì™¸

### 3. ì„±ëŠ¥ ê°œì„ 
- HTF ìº”ë“¤ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 96% ê°ì†Œ (1500ê°œ â†’ 50ê°œ)
- êµ¬ì¡° ë¶„ì„ ì†ë„ í–¥ìƒ
- ë” ë¹ ë¥¸ ì‹ í˜¸ ê°ì§€ ê°€ëŠ¥

## ğŸ”§ í™˜ê²½ ë³€ìˆ˜ ì„¤ì •

`.env` íŒŒì¼ì—ì„œ ë‹¤ìŒ ì„¤ì • ê°€ëŠ¥:

```bash
# HTF ìº”ë“¤ ìˆ˜ ì œí•œ (ê¸°ë³¸ê°’: 50)
HTF_CANDLE_LIMIT=50

# OTE ê²€ì¦ ì‚¬ìš© ì—¬ë¶€ (ê¸°ë³¸ê°’: false)
USE_OTE_VALIDATION=false
```

## âœ… í™•ì¸ ì‚¬í•­

1. **ìº”ë“¤ ë°ì´í„°**: HTF ìº”ë“¤ì´ 50ê°œë¡œ ì œí•œë˜ì–´ ì €ì¥ë¨
2. **OTE ë¹„í™œì„±í™”**: OTE ê²€ì¦ ë¡œì§ì´ ì‚¬ìš©ë˜ì§€ ì•ŠìŒ
3. **ë¶„ì„ ì •í™•ë„**: ì¶©ë¶„í•œ ìº”ë“¤ ìˆ˜ í™•ë³´ ì‹œì—ë§Œ ë¶„ì„ ì§„í–‰
4. **ì„±ëŠ¥**: ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ë° ì²˜ë¦¬ ì†ë„ ê°œì„ 

## ğŸš¨ ì£¼ì˜ì‚¬í•­

- HTF ìº”ë“¤ ìˆ˜ê°€ 50ê°œë¡œ ì œí•œë˜ì–´ ì¥ê¸°ê°„ ë°±í…ŒìŠ¤íŠ¸ ì‹œ ì£¼ì˜ í•„ìš”
- ì‹ ê·œ ì‹¬ë³¼ ì¶”ê°€ ì‹œ ì´ˆê¸° ìº”ë“¤ ìˆ˜ì§‘ ì‹œê°„ ë‹¨ì¶•
- OTE ë¡œì§ ì¬í™œì„±í™”ê°€ í•„ìš”í•œ ê²½ìš° `USE_OTE_VALIDATION=true` ì„¤ì • í›„ ê´€ë ¨ ë¡œì§ ì¶”ê°€ í•„ìš”